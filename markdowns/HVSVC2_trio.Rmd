
```{r prep, echo=FALSE,warning=FALSE, include=FALSE}

require(tidyr)
require(ggplot2)
require(data.table)
require(openssl)
require(dplyr)
require(optparse)
require(callr)
codelib<-'/home/jbonnie1/scr16_blangme2/jessica/dandd/dev-dandD/lib/'
source(file.path(codelib,'plot_progressive.R'))

outdir<-'/home/jbonnie1/scr16_blangme2/jessica/dandd/scratch/HVSVC2'

```


## Run random orderings for 10 genomes with only SNVs

```{bash}
outdir=/scratch16/blangme2/jessica/dandd/scratch/HVSVC2
tag=trio
filelist=/scratch16/blangme2/jessica/data/HVSVC2/consensus_mom_fchild_and_onef.txt
#_HG0111|
grep -E "(_HG00513|_HG00514|_HG01114)" /home/jbonnie1/scr16_blangme2/jessica/data/HVSVC2/consensus_fastas.txt > ${filelist}

sketchdir=${outdir}/sketchdb

python /scratch16/blangme2/jessica/dandd/dev-dandD/lib/dandd_cmd.py tree -s ${tag} -f ${filelist} -o ${outdir} -k 19 |& tee ${outdir}/${tag}_trio.log

tree_pick=/scratch16/blangme2/jessica/dandd/scratch/HVSVC2/trio_6_dashing_dtree.pickle

python /scratch16/blangme2/jessica/dandd/dev-dandD/lib/dandd_cmd.py progressive -d ${tree_pick} -n 300 -o ${outdir}/${tag}_progu.csv

#../scratch/progressive_union/sketches/HVSVC2/k20/ngen1/allvar_HG00513_1.fasta.gz.w.20.spacing.20.hll

```



```{r draw_graphs1, cache=TRUE}
tag='trio'
ngenome=6

delta_trio<-read.csv('/scratch16/blangme2/jessica/dandd/scratch/HVSVC2/trio_progu.csv') %>% 
  rename(delta_pos=delta, ngenomes=ngen)
plotProgressiveUnion(species=tag, out = outdir, delta_trio, nshow=10)


```

```{r abba, cache=TRUE}
abba.trio <- read.csv('/scratch16/blangme2/jessica/dandd/scratch/HVSVC2/trio_abba.csv')
ggplot(abba.trio) + geom_boxplot(aes(x=as.factor(step),y=deltadelta)) + scale_y_log10()

```


```{r abba2}
ggplot(abba.trio) + geom_boxplot(aes(x=as.factor(step),y=deltadelta, color=as.factor(HG00514_1))) + geom_point(aes(x=as.factor(step),y=deltadelta, color=as.factor(HG00514_1))) + scale_y_log10() 
ggplot(abba.trio) + geom_boxplot(aes(x=as.factor(step),y=deltadelta, color=as.factor(HG00514_2))) + geom_point(aes(x=as.factor(step),y=deltadelta, color=as.factor(HG00514_2))) + scale_y_log10()
```


```{r explode}
abba.trio %>% filter(HG00514_1 == 0 & step==3 & HG00513_1 == 1 & HG00513_2 == -1) -> mom1
abba.trio %>% filter(HG00514_1 == 0 & step==3 & (HG00513_1 == 1 | HG00513_2 == 1)) -> allmommy
abba.trio %>% filter(HG00514_1 == 0 & step==3 & HG00513_1 == -1 & HG00513_2 == 1) -> mom2
abba.trio %>% filter(HG00514_1 == 0 & step==3 & HG00513_1 == -1 & HG00513_2 == -1) -> nomommy
nomommy$deltadelta %>% unique()
View(nomommy)

```



